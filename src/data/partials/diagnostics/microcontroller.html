<div
  class="diag-section orange"
  x-init="$store.diagnostics.triggerProgressAnimations()"
>
  <div class="diag-header">
    <h4 class="diag-title orange">
      <span
        x-html="window.renderSectionIcon ? window.renderSectionIcon('cpuChip') : 'ðŸ–¥ï¸'"
      ></span>
      Microcontroller
    </h4>
  </div>
  <div class="space-y-2">
    <div class="diag-row">
      <span class="diag-label">Chip Model:</span>
      <span
        class="diag-value"
        x-text="$store.diagnostics.microcontrollerInfo.chipModel"
      ></span>
    </div>
    <div class="diag-row">
      <span class="diag-label">CPU Frequency:</span>
      <span
        class="diag-value"
        x-text="$store.diagnostics.microcontrollerInfo.cpuFrequency"
      ></span>
    </div>
    <div class="diag-row">
      <span class="diag-label">Flash Size:</span>
      <span
        class="diag-value"
        x-text="$store.diagnostics.microcontrollerInfo.flashSize"
      ></span>
    </div>
    <div class="diag-row">
      <span class="diag-label">Firmware Version:</span>
      <span
        class="diag-value"
        x-text="$store.diagnostics.microcontrollerInfo.firmwareVersion"
      ></span>
    </div>
    <div class="diag-row">
      <span class="diag-label">Uptime:</span>
      <span
        class="diag-value"
        x-text="$store.diagnostics.microcontrollerInfo.uptime"
      ></span>
    </div>
    <div class="diag-row">
      <span class="diag-label">Temperature:</span>
      <span
        class="diag-value"
        x-text="$store.diagnostics.microcontrollerInfo.temperature"
      ></span>
    </div>

    <!-- Memory Usage -->
    <div class="diag-row">
      <span class="diag-label">Flash Usage:</span>
      <span
        class="diag-value"
        x-text="$store.diagnostics.memoryUsage.flashUsageText"
      ></span>
    </div>
    <div class="diag-progress-bar">
      <div
        :class="getProgressBarClass($store.diagnostics.memoryUsage.flashUsagePercent)"
        class="h-full rounded-full transition-all duration-1000 ease-out"
        :style="$store.diagnostics.progressReady ? `width: ${Math.min(Math.max($store.diagnostics.memoryUsage.flashUsagePercent, 0), 100)}%` : 'width: 0%'"
      ></div>
    </div>

    <div class="diag-row">
      <span class="diag-label">Heap Usage:</span>
      <span
        class="diag-value"
        x-text="$store.diagnostics.memoryUsage.heapUsageText"
      ></span>
    </div>
    <div class="diag-progress-bar">
      <div
        :class="getProgressBarClass($store.diagnostics.memoryUsage.heapUsagePercent)"
        class="h-full rounded-full transition-all duration-1000 ease-out"
        :style="$store.diagnostics.progressReady ? `width: ${Math.min(Math.max($store.diagnostics.memoryUsage.heapUsagePercent, 0), 100)}%` : 'width: 0%'"
      ></div>
    </div>

    <!-- MQTT Status -->
    <div class="diag-row">
      <span class="diag-label">MQTT Status:</span>
      <span class="diag-value">
        <template x-if="!$store.diagnostics.config?.mqtt?.enabled">
          <span class="text-gray-600 dark:text-gray-400">Disabled</span>
        </template>
        <template x-if="$store.diagnostics.config?.mqtt?.enabled">
          <span
            :class="$store.diagnostics.config?.mqtt?.connected ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'"
            x-text="$store.diagnostics.config?.mqtt?.connected ? 'Connected' : 'Disconnected'"
          ></span>
        </template>
      </span>
    </div>
    <template x-if="$store.diagnostics.config?.mqtt?.enabled">
      <div class="diag-row">
        <span class="diag-label">MQTT Server:</span>
        <span
          class="diag-value"
          x-text="$store.diagnostics.config?.mqtt?.server || 'Not configured'"
        ></span>
      </div>
    </template>
  </div>
</div>
